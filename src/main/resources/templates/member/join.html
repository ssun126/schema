<!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name='generator' content='Schema'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" type="text/css" href="../../../plugin/jqGrid/jQuery.jqGrid.css" >
    <link rel="stylesheet" type="text/css" href="../../../plugin/jqGrid/ui.jqGrid.css" >
    <link rel="stylesheet" type="text/css" href="../../../css/style.css" >
    <link rel="stylesheet" type="text/css" href="../../../css/schema.css" >

    <script type="text/javascript" src="../../../plugin/jquery/jquery-3.7.1.min.js"></script>
    <script type="text/javascript" src="../../../plugin/jqueryUi/jquery-ui.js"></script>
    <script type="text/javascript" src="../../../plugin/jqGrid/jquery.jqGrid.js"></script>
    <script type="text/javascript" src="../../../js/app.js"></script>
    <title>회원가입</title>
</head>
<body>
<div class="cui_app">
    <div class="cui_global">
        <h1 class="global_logo">
            <a href="#" onclick="goMenu('/main')"><span class="blind">동우화인캠</span></a>
        </h1>
        <nav class="cui_gnb" role="navigation">
            <ul>
                <li class="more">
                    <a href="#" class="toggle"><span>더보기</span></a>
                    <ul></ul>
                </li>
            </ul>
        </nav>
        <div class="global_utility">
            <div class="utility_profile">
                <div class="info">
                    <strong>안녕하세요.</strong>
                </div>
            </div>
            <button type="button" class="global_icon" data-cui-icon="logout" data-tooltip-title="Home"  onclick="goMenu('/logout')"><span>Home</span></button>
        </div>
    </div>
    <div class="cui_container center" data-module="join">
        <div class="cui_lnb">
            <div class="lnb_root">
                <div class="lnb_head">
                    <h2 class="lnb_title"><span>회원가입</span></h2>
                </div>
                <div class="cui_nav">
                    <nav class="nav_root">
                        <ul>
                            <li>
                                <a href="#" class="nav_item">
                                    <span class="nav_label">회원가입</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <div class="cui_content " data-module="join">
            <div class="cui_main">
                <div class="cui_head">
                    <div class="head_content">
                        <h2 class="cui_title center"><span>회원가입</span></h2>
                    </div>
                </div>
                <div class="cui_body">
                    <div class="cui_step">
                        <ol>
                            <li>
                                <i data-cui-icon="file_search"></i>
                                <span>정보수집 동의</span>
                            </li>
                            <li class="active">
                                <i data-cui-icon="lock"></i>
                                <span>ID/PW 및 벤더정보</span>
                            </li>
                            <li>
                                <i data-cui-icon="receipt"></i>
                                <span>워런티 협약</span>
                            </li>
                            <li>
                                <i data-cui-icon="task"></i>
                                <span>동우 승인</span>
                            </li>
                        </ol>
                    </div>
                    <form id="frmJoin" class="cui_form_field" data-legend="true" action="/member/warranty" method="post">
                        <fieldset>
                            <legend><span>기본정보</span></legend>
                            <table class="cui_table">
                                <colgroup>
                                    <col style="width:154px;">
                                    <col>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th><span>Vendor 번호 및 사업자등록번호 검색</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <select class="cui_select_field" id = "searchCustomerType">
                                                    <option value="VendorNum">Vendor 번호</option>
                                                    <option value="BusinessNum">사업자등록 번호</option>
                                                </select>
                                                <input name ="COM_CODE" class="cui_text_field" type="text"  id = "searchCustomer">
                                                <button type="button" class="cui_button icon" data-cui-icon="search" onclick ="vendorCheck()"><span>검색</span></button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>

                                </tr>
                                <tr>
                                    <th><span>귀사 정보</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text"  id="COM_NAME" disabled>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>Vendor 업종 형태</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-wrap="wrap" data-direction="left">
                                            <div class="item_content">
                                                <label class="cui_checkbox"><input type="radio" name="VENDOR_WORK_KIND" value="D" id="Manufacturer" ><i></i><span>제조사</span></label>
                                                <label class="cui_checkbox"><input type="radio" name="VENDOR_WORK_KIND" value="L" id="Logistics"><i></i><span>물류사</span></label>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>국가</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text"  name="COM_NATION" id="COM_NATION" disabled>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="cui_alert alert_basic" data-type="info" role="alert" id="firstCompany">
                                <div class="alert_message">
                                    <p>최초등록 업체입니다.</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="info" role="alert" id="registeredCompany">
                                <div class="alert_message">
                                    <p>기등록 업체입니다.</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id="noCompanyCode">
                                <div class="alert_message">
                                    <p>업체코드 내역이 없어 가입이 불가합니다.</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="info" role="alert" id="errCompanyCode">
                                <div class="alert_message">
                                    <p id=errCompanyCodeMsg></p>
                                </div>
                            </div>
                        </fieldset>

                        <div><br /></div>

                        <div id="joinBasicStep1">

                        <fieldset id="userInfoFieldset">
                            <legend><span>공동 업무자 정보</span></legend>

                            <table class="cui_table center">
                                <thead>
                                <tr>
                                    <th><span>성명(영문)</span></th>
                                    <th><span>직위</span></th>
                                    <th><span>부서명</span></th>
                                    <th><span>email</span></th>
                                    <th><span>연락처</span></th>
                                    <th><button type="button" class="cui_button secondary" id="addRowButton" ><span>추가</span></button></th>
                                </tr>
                                </thead>
                                <tbody id="tableBody">
                                <tr>
                                    <td><input type="text" class="cui_text_field" name="USER_NAME" placeholder="이름"  onblur="setUserSelectReset()"></td>
                                    <td><input type="text" class="cui_text_field" name="USER_POSITION" onblur="setUserSelectReset()"></td>
                                    <td><input type="text" class="cui_text_field" name="USER_DEPT"  onblur="setUserSelectReset()"></td>
                                    <td><input type="text" class="cui_text_field" name="USER_EMAIL" placeholder="이메일" id="USER_EMAIL"  onblur="setUserSelectReset()"></td>
                                    <td><input type="text" class="cui_text_field" name="USER_PHONE" placeholder="전화번호"  onblur="setUserSelectReset()"></td>
                                    <td></td>
                                </tr>
                                </tbody>
                            </table>
                        </fieldset>

                        <fieldset>
                            <legend><span>ID/PW</span></legend>
                            <table class="cui_table">
                                <colgroup>
                                    <col style="width:154px;">
                                    <col>
                                    <col style="width:154px;">
                                    <col>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th><span>ID</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text" name = "USER_ID" id ="memberID" >
                                                <button type="button" class="cui_button icon" data-cui-icon="search" id="btnIdCheck"  onclick ="memberIDCheck()"><span>중복검사</span></button>
                                            </div>
                                        </div>
                                    </td>
                                    <th><span>담당자</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <select class="cui_select_field wide" name ="USERSELECT" id="userSelect" >
                                                    <option value="0">담당자 목록</option>
                                                </select>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>PW</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="password" name ="USER_PWD" id="UserPass" placeholder="비밀번호" onblur="passConfirm()">
                                            </div>
                                        </div>
                                    </td>
                                    <th><span>PW 확인</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="password" id="UserPassRe" onkeyup="passConfirm()" placeholder="비밀번호 확인" onblur="passConfirm()">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr id="tr_id_pw_add_reason" >
                                    <th><span>ID/PW 추가사유</span></th>
                                    <td colspan="3">
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input name="ID_PW_ADD_REASON" id="ID_PW_ADD_REASON" class="cui_text_field wide" type="text">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id = "dupliCation">
                                <div class="alert_message">
                                    <p>동일 사업부/공장에서 업무자별 ID 생성은 승인 불가 합니다</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id ="missPass">
                                <div class="alert_message">
                                    <p>ID/PW 문의는 Main 담당자 또는 '공동업무자'에게 문의 바랍니다.</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id ="selectOwner">
                                <div class="alert_message">
                                    <p style = "color: #E40087;">담당자를 선택해 주세요.</p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id ="IdVAL">
                                <div class="alert_message">
                                    <p><span id ="IdValidatorMsg"></span></p>
                                </div>
                            </div>
                            <div class="cui_alert alert_basic" data-type="warning" role="alert" id ="PassVAL">
                                <div class="alert_message">
                                    <p><span id ="confirmMsg"></span></p>
                                </div>
                            </div>
                        </fieldset>

                        <fieldset>
                            <legend><span>업체정보</span></legend>
                            <table class="cui_table">
                                <colgroup>
                                    <col style="width:154px;">
                                    <col>
                                    <col style="width:154px;">
                                    <col>
                                </colgroup>
                                <tbody>
                                <tr>
                                    <th><span>회사명 (한글 또는 해당국가 언어)</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text" name = "COMPANY_NAME" id="COMPANY_NAME">
                                            </div>
                                        </div>
                                    </td>
                                    <th><span>제조 공장명</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text" name = "FACTORY_NAME" id="FACTORY_NAME">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>사업자 등록번호</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text"  name = "BUS_NUMBER" id="BUS_NUMBER">
                                            </div>
                                        </div>
                                    </td>
                                    <th><span>회사주소 (영문)</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text"  name = "COM_ADDRESS" id="COM_ADDRESS">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>CEO 성명(영문)</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text"  name = "COM_CEO_NAME" id="COM_CEO_NAME">
                                            </div>
                                        </div>
                                    </td>
                                    <th><span>CEO 연락처(영문)</span></th>
                                    <td>
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text" name = "COM_CEO_PHONE" id="COM_CEO_PHONE">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>CEO e-mail(영문)</span></th>
                                    <td colspan="3">
                                        <div class="cui_items_wrap" data-direction="left">
                                            <div class="item_content">
                                                <input class="cui_text_field" type="text" name ="COM_CEO_EMAIL" id ="COM_CEO_EMAIL">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th><span>접속 목적</span></th>
                                    <td colspan="3">
                                        <div class="cui_items_wrap" data-direction="column">
                                            <div class="item_content">
                                                <div id="divGoal" class="item_content wrap" style="display: flex; flex-wrap: wrap;" >
                                                    <label class="cui_checkbox wide"><input type="checkbox" name="checkbox1"><i></i><span>Audit Management (노동환경)</span></label>
                                                </div>
                                                <!-- JSON 데이터를 저장할 숨겨진 필드 -->
                                                <input type="hidden" name="checkboxDataJson" id="checkboxDataJson">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </fieldset>

                        <div class="cui_items_wrap" data-direction="right" >
                            <div class="item_content">
                                <a href="#" onclick="return chk_form()" class="cui_button primary"><span>다음</span></a>
                            </div>
                        </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>

    const goMenu = (menuPage) => {
        location.href = menuPage;
    }


    $(document).ready(function() {

         hideCompanyStatusInfo();
         hideMemberInfo();
         $('#searchCustomer').focus();
         $('#joinBasicStep1').hide();

         $('#addRowButton').on('click', function() {
            // 공동 업무자 정보 생성
            const newRow = `
                <tr>
                    <td><input type="text" class="cui_text_field" name="USER_NAME" placeholder="이름"  onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_POSITION" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_DEPT" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_EMAIL" placeholder="이메일"  onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_PHONE" placeholder="전화번호"  onclick="setUserSelectReset()"></td>
                    <td><button type="button" class="cui_button icon" data-cui-icon="trash" id="delRowButton"><span>삭제</span></button></td>
                </tr>
            `;

            $('#tableBody').append(newRow);
            setUserSelectReset();
        });

        // 공동 업무자 정보 삭제
        $(document).on('click', '#delRowButton', function() {
            $(this).closest('tr').remove();
            setUserSelectReset() //담당자 목록 컨트롤 바인딩 초기화
        });

        // 아이디 입력창 정보 가져오기
        let elInputUSER_NAME = document.querySelector('#memberID');

        //ID /PASS 유효성 //
        elInputUSER_NAME.onkeyup = function (event) {

        if (event.key === 'Enter' || event.keyCode === 13) {
           return;
        }

         var correctColor = "#18AD72";
         var wrongColor = "#E40087" ;

          IdValidatorMsg.style.color = wrongColor;

          // 값을 입력한 경우
          if (elInputUSER_NAME.value.length !== 0) {
            // 영어 또는 숫자 외의 값을 입력했을 경우
            if(onlyNumberAndEnglish(elInputUSER_NAME.value) === false) {
                $('#IdVAL').show();
                IdValidatorMsg.innerHTML = "영어 또는 숫자만 가능합니다.";
            }
            // 글자 수가 4~12글자가 아닐 경우
            else if(idLength(elInputUSER_NAME.value) === false) {
                $('#IdVAL').show();
                IdValidatorMsg.innerHTML = "아이디는 6~12글자이어야 합니다.";
            }
            // 조건을 모두 만족할 경우
            else if(idLength(elInputUSER_NAME.value) || onlyNumberAndEnglish(elInputUSER_NAME.value)) {

               $('#IdVAL').show();
               IdValidatorMsg.style.color = correctColor;
               IdValidatorMsg.innerHTML = "사용할 수 있는 아이디입니다.[중복 체크를 해 주세요]";
            }
          }
          // 값을 입력하지 않은 경우 (지웠을 때)
          else {
                //$('#IdVAL').hide();
                 $('#IdVAL').show();
                IdValidatorMsg.innerHTML = "아이디는 6~12글자이어야 합니다.";
          }
        }
    });


    function setUserSelect(users) {

        var userSelect = document.getElementById('userSelect');

        users.forEach(function(user) {

            var option = document.createElement('option');
            //option.value = user.email;
            option.value = user.name;        // 이름을 value 값으로 설정  //추후 동명이인 처리시 고민해보자
            option.textContent = user.name;  // 이름을 표시

            userSelect.appendChild(option);
        });
    }

    //담당자 리셋
    function setUserSelectReset() {

       $("#userSelect option").remove();
       $("#userSelect").append("<option value='0'>담당자 목록</option>");

       var userList = extractData() ;
       setUserSelect(userList);

       $('#selectOwner').show();
    }

    // 공동 업무자 정보 데이터 추출
    function extractData() {

        var rows = document.querySelectorAll('#tableBody tr');
        var userList = [];

        rows.forEach(function(row) {
            var userData = {};
            var name = row.querySelector('input[name="USER_NAME"]').value;
            var email = row.querySelector('input[name="USER_EMAIL"]').value;

            userData.name = name;
            userData.email = email;

            userList.push(userData);
        });

        return userList;
    }


    //밴더 사업자 검색후 표기 초기화
    function hideCompanyStatusInfo () {
      $('#firstCompany').hide();
      $('#registeredCompany').hide();
      $('#noCompanyCode').hide();
      $('#errCompanyCode').hide();
    }

    function hideMemberInfo () {
      $('#IdVAL').hide();
      $('#dupliCation').hide();
      $('#missPass').hide();
    }


    // 기본 정보 조회 Vendor 번호,사업자 등록번호 체크
    const vendorCheck = () => {
    const searchType = document.getElementById("searchCustomerType").value;
    const searchCustomer = document.getElementById("searchCustomer").value;

      hideCompanyStatusInfo();

      if (!searchCustomer) {
         $('#searchCustomer').focus();
         if(searchType == "VendorNum"){
             alert("Vendor 번호를 입력해주세요.");
         } else{
             alert("사업자등록번호를 입력해주세요.");
         }
        return;
      }

      if(searchType == "VendorNum"){
            document.getElementById('BUS_NUMBER').readOnly = false;
      } else{
            document.getElementById('BUS_NUMBER').readOnly = true;
      }

      var sUrl = "/member/vendor-check" ;
      $.ajax({
          type: "post",
          url:   sUrl,
          data: {
              "searchCode": searchCustomer
              ,"searchType" : searchType
          },
          success: function(res) {

              if (res.status == "ok") {
               $('#registeredCompany').show();             //기등록 업체입니다.(추가 ID 작업)
               $('#joinBasicStep1').show();

                bindCompanyInfo(res);                      //정보 바인딩. ★
                bindMemberGoalList(res.memberGoalList);    //접속목적 바인딩. ★
                unbindCompanyUserInfo();
                setFieldsReadOnly(false);

              } else if (res.status == "not") {            //IF 코드 없음.

                $('#noCompanyCode').show();
                $('#joinBasicStep1').hide();

                document.getElementById('Logistics').checked = false;
                document.getElementById('Manufacturer').checked = false;
                document.getElementById("COM_NAME").value = "" ;
                document.getElementById("COM_NATION").value = "";
                unbindCompanyUserInfo();

              } else if (res.status == "no") {  //신규.

                $('#firstCompany').show();
                $('#joinBasicStep1').show();
                bindCompanyInfo(res);                       //정보 바인딩. ★
                bindCompanyUserList(res.companyUserList);
                bindMemberGoalList(res.memberGoalList);    //접속목적 바인딩. ★
                unbindCompanyUserInfo();
                setFieldsReadOnly(false);

              }else {                                      //가입 진행중.
                $('#errCompanyCode').show();
                $('#joinBasicStep1').show();  //기존 신청 정보 수정 가능하게.

                bindCompanyInfo(res);                      //정보 바인딩. ★
                bindCompanyUserInfo(res);
                bindMemberGoalList(res.memberGoalList);    //접속목적 바인딩. ★

                if(res.companyUserList != "undefined"){
                    bindCompanyUserList(res.companyUserList);
                }
                setFieldsReadOnly(true);
                errCompanyCodeMsg.innerHTML = "["+ res.status + "] 중인 정보가 있습니다. 관리자에게 문의하세요" ;
              }
          },
          error: function(err) {
              console.log("에러발생", err);
          }
      });
    }

    //가입신청 된거 있을때 공동 업무자 정보 바인딩
    function bindCompanyUserList(companyUserList) {
       const tableBody = document.getElementById("tableBody");
        tableBody.innerHTML = ''; // 기존 행 초기화

        if (companyUserList === undefined || companyUserList.length === 0) {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td><input type="text" class="cui_text_field" name="USER_NAME" placeholder="이름" onclick="setUserSelectReset()"></td>
                <td><input type="text" class="cui_text_field" name="USER_POSITION" placeholder="직위" onclick="setUserSelectReset()"></td>
                <td><input type="text" class="cui_text_field" name="USER_DEPT" placeholder="부서명" onclick="setUserSelectReset()"></td>
                <td><input type="text" class="cui_text_field" name="USER_EMAIL" placeholder="이메일" onclick="setUserSelectReset()"></td>
                <td><input type="text" class="cui_text_field" name="USER_PHONE" placeholder="전화번호" onclick="setUserSelectReset()"></td>
                <td></td>
            `;
            tableBody.appendChild(row);
        } else {

            companyUserList.forEach((item, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td><input type="text" class="cui_text_field" name="USER_NAME" value="${item.USER_NAME}" placeholder="이름" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_POSITION" value="${item.USER_POSITION}" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_DEPT" value="${item.USER_DEPT}" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_EMAIL" value="${item.USER_EMAIL}" placeholder="이메일" onclick="setUserSelectReset()"></td>
                    <td><input type="text" class="cui_text_field" name="USER_PHONE" value="${item.USER_PHONE}" placeholder="전화번호" onclick="setUserSelectReset()"></td>
                    <td>${index === 0 ? '' : '<button type="button" class="cui_button icon" data-cui-icon="trash" id="delRowButton"><span>삭제</span></button>'}</td>
                `;
                tableBody.appendChild(row);
            });
        }
    }



    //기본정보 바인딩
    function bindCompanyInfo(companyInfo) {

        if (companyInfo) {
            document.getElementById("COM_NAME").value = companyInfo.COM_NAME ;   //귀사정보

            // (D:제조사, L:물류사)
            var  selectedOption = companyInfo.VENDOR_WORK_KIND ;
            if (selectedOption === "D") {  //(D:제조사, L:물류사)
              document.getElementById('Manufacturer').checked = true;
              document.getElementById('Logistics').checked = false;
            } else if (selectedOption === "L") {
              document.getElementById('Manufacturer').checked = false;
              document.getElementById('Logistics').checked = true;

            }else{
              document.getElementById('Logistics').checked = false;
              document.getElementById('Manufacturer').checked = false;
            }
            document.getElementById("COM_NATION").value =  companyInfo.COM_NATION;  //국가
            document.getElementById("COMPANY_NAME").value =  companyInfo.COMPANY_NAME;  //회사명
            document.getElementById("FACTORY_NAME").value =  companyInfo.FACTORY_NAME; //제조 공장명
            document.getElementById("BUS_NUMBER").value =  companyInfo.BUS_NUMBER;  //사업자등록번호
            document.getElementById("COM_ADDRESS").value =  companyInfo.COM_ADDRESS;   //회사주소
            document.getElementById("COM_CEO_NAME").value =  companyInfo.COM_CEO_NAME;   //CEO 성명 (영문)
            document.getElementById("COM_CEO_PHONE").value =  companyInfo.COM_CEO_PHONE; //CEO 연락처 (영문)
            document.getElementById("COM_CEO_EMAIL").value =  companyInfo.COM_CEO_EMAIL; //CEO e-mail (영문)
        }
    }

    //공동사용자 기본정보 바인딩
    function bindCompanyUserInfo(companyInfo) {

        if (companyInfo) {
            //ID
            $("#userSelect option").remove();
            $("#userSelect").append("<option value='0'>담당자 목록</option>");

            document.getElementById("memberID").value =  companyInfo.USER_ID;
            //document.getElementById("userSelect").value =  companyInfo.USER_NAME;
            var select = document.getElementById("userSelect");
            var option = document.createElement("option");
            option.value =companyInfo.USER_NAME;  //메인 업무자 셋팅.
            option.text = companyInfo.USER_NAME;
            select.appendChild(option);
            option.selected = true;

            companyInfo.companyUserList.forEach((item) => {
				if(item != null && item.USER_NAME != companyInfo.USER_NAME ){
				 var optionAdd = document.createElement("option");
					optionAdd.value = item.USER_NAME;
					optionAdd.text  = item.USER_NAME;
					select.appendChild(optionAdd);
				}
            });

            document.getElementById("ID_PW_ADD_REASON").value =  companyInfo.ID_PW_ADD_REASON;

            //유효성
            $('#IdVAL').show();
            $('#selectOwner').hide(); //담당자선택 메세지


            IdValidatorMsg.style.color = "#18AD72";
            IdValidatorMsg.innerHTML = "사용할 수 있는 아이디입니다.";
            passConfirm();
            //document.querySelector('#memberID').onkeyup(event); //그대로 넘겨야됨.

        }
    }

    //접속목적 바인딩
    function bindMemberGoalList(memberGoalList) {

        const divGoal = $('#divGoal');

        divGoal.empty();

        memberGoalList.forEach(function(memberGoal) {

            const checkbox = $('<input>', {
                type: 'checkbox',
                id: memberGoal.base_CODE,
                name: memberGoal.base_CODE,
                checked: memberGoal.user_ID !== null
            });

            const label = $('<label>', { class: 'cui_checkbox wide' });
            label.append(checkbox);
            label.append('<i></i>');
            label.append($('<span>').text(memberGoal.base_NAME));

            divGoal.append(label);
        });
    }

    //바인딩 초기화
        function unbindCompanyUserInfo() {

            //ID
            document.getElementById("memberID").value = "";
            setUserSelectReset();

            document.getElementById("UserPass").value =  "";
            document.getElementById("UserPassRe").value =  "";
            document.getElementById("ID_PW_ADD_REASON").value = "";

            //유효성
            $('#selectOwner').show(); //담당자선택 메세지
            passConfirm();
            document.querySelector('#memberID').onkeyup(event);

    }


    // member ID 체크
    //01 .memberID 키에
    // IdValidatorMsg.innerHTML = "사용할 수 있는 아이디입니다"; 이거 일때 체크 걸자. 안되면 가입도 안된다.
    // 버튼 클릭시 memberIDCheck() 중복검사.

    const memberIDCheck = () => {

    const searchID = document.getElementById("memberID").value;

    const message = document.getElementById('IdValidatorMsg').innerHTML;

    if(message != "사용할 수 있는 아이디입니다.[중복 체크를 해 주세요]"){
        //alert('중복 체크 완료!')
        return;
    }

      $.ajax({
          // 요청방식: post, url: "vendor-check", 데이터:  member ID 중복체크
          type: "post",
          url:  "/member/id-check",
          data: {
              "memberID": searchID
          },
          success: function(res) {

              hideMemberInfo();// 정보 숨기기.
              $('#IdVAL').show();

              if (res == "ok") {
                document.getElementById('IdValidatorMsg').innerHTML = "사용할 수 있는 아이디입니다."
              } else {
               IdValidatorMsg.style.color = "#E40087";
               document.getElementById('IdValidatorMsg').innerHTML = "동일한 아이디가 존재합니다."
              }
          },
          error: function(err) {
              console.log("에러발생", err);
          }
      });
    }

    // 이메일 입력값을 가져오고,
    // 입력값을 서버로 전송하고 똑같은 이메일이 있는지 체크한 후
    // 사용 가능 여부를 이메일 입력창 아래에 표시
    const emailCheck = () => {
      const email = document.getElementById("USER_EMAIL").value;
      const checkResult = document.getElementById("check-result");
      console.log("입력한 이메일", email);
      $.ajax({
          // 요청방식: post, url: "email-check", 데이터: 이메일
          type: "post",
          url: "/member/email-check",
          data: {
              "USER_EMAIL": email
          },
          success: function(res) {
              console.log("요청성공", res);
              if (res == "ok") {
                  console.log("사용가능한 이메일");
                  checkResult.style.color = "green";
                  checkResult.innerHTML = "사용가능한 이메일";
              } else {
                  console.log("이미 사용중인 이메일");
                  checkResult.style.color = "red";
                  checkResult.innerHTML = "이미 사용중인 이메일";
              }
          },
          error: function(err) {
              console.log("에러발생", err);
          }
      });
    }

    document.getElementById('searchCustomer').addEventListener('keydown', function(event) {
        if (event.key === 'Enter' || event.keyCode === 13) {
            vendorCheck();
        }
    });

    document.getElementById('memberID').addEventListener('keydown', function(event) {
        if (event.key === 'Enter' || event.keyCode === 13) {
            memberIDCheck();
        }
    });

    document.getElementById('userSelect').addEventListener('change', function() {
        const selectedValue = this.value;
        if (selectedValue == "0") {
            $('#selectOwner').show()
        } else {
         $('#selectOwner').hide()
        }
    });

    function setFieldsReadOnly(bool) {

        var fieldset = document.getElementById('userInfoFieldset');

        var inputs = fieldset.querySelectorAll('input[type="text"]');
        var buttons = fieldset.querySelectorAll('button[type="button"]');

        inputs.forEach(function(input) {
            input.readOnly = bool;
        });

        buttons.forEach(function(button) {
            button.disabled = bool;
        });

        //ID

        var button = document.getElementById('btnIdCheck');
        button.disabled = bool;

        var input = document.getElementById('memberID');
        input.readOnly = bool;

        var userselect = document.getElementById('userSelect');
        userselect.readOnly = bool;

    }

    // Member / Pass 가입 ///////////////////

    <!--1. 회원가입 항목 조건-->
    <!--아이디 : 4~12글자, 영어나 숫자만 가능하다.-->
    <!--비밀번호 : 8글자 이상, 영문, 숫자, 특수문자를 모두 사용해야 한다.-->
    <!--비밀번호 확인 : 비밀번호와 일치해야 한다.-->

    //2-1. 아이디 : 글자 수 제한 (6글자 이상, 12글자 이하)
    function idLength(value) {
      return value.length >= 6 && value.length <= 12
    }
    //6글자 이상 또는 12글자 이하인 경우 true, 아니면 false를 리턴한다.


    //2-2. 아이디 : 영어 또는 숫자만 가능
    function onlyNumberAndEnglish(str) {
      return /^[A-Za-z0-9][A-Za-z0-9]*$/.test(str);
    }
    //영어 또는 숫자가 들어간 경우 true, 아니면 false를 리턴한다.
    //test() : 문자열에 일치하는 부분이 있는지 확인한다. true 또는 false를 반환

    //2-3.Pass 유효성  , 비교
	function passConfirm() {
        var UserPass = document.getElementById('UserPass');
        var UserPassRe = document.getElementById('UserPassRe');
        var confirmMsg = document.getElementById('confirmMsg');
        var correctColor = "#18AD72";
        var wrongColor = "#E40087" ;

        // 정규식: 6자리 이상 숫자와 영문 (대문자 또는 소문자) 포함
        const regex = /^(?=.*[a-zA-Z])(?=.*\d)[a-zA-Z\d]{6,}$/;

        if (regex.test(UserPass.value)) {
            confirmMsg.style.color = correctColor;
            //confirmMsg.innerHTML =  "비밀번호가 유효합니다.";

            if (UserPass.value === UserPassRe.value) {
                confirmMsg.style.color = correctColor;
                confirmMsg.innerHTML = "비밀번호가 일치합니다.";
            } else {
                confirmMsg.style.color = wrongColor;
                confirmMsg.innerHTML = "비밀번호가 일치하지 않습니다.";
            }

        } else {
            confirmMsg.style.color = wrongColor;
            confirmMsg.innerHTML = "비밀번호는 6자리 이상의 숫자와 영문자로만 구성되어야 합니다.";
        }
    }

    //submit 전 체크
    function chk_form() {

        const message = document.getElementById('IdValidatorMsg').innerHTML;
        if(message != "사용할 수 있는 아이디입니다."){
            alert("아이디를 확인해 주십시오.");
            $('#memberID').focus();
            return;
        }

        const selectedValue = document.getElementById('userSelect').value;
        if (selectedValue == "0") {
            $('#selectOwner').focus();
            alert("담당자를 선택해 주세요.");
            return;
        }

        if (selectedValue == "" ) {
            $('#selectOwner').focus();
            alert("공동 업무자 정보를 확인해주세요. 기본 1인은 필수 입니다.");
            return;
        }

        const confirmMsg = document.getElementById('confirmMsg').innerHTML;
        if(confirmMsg != "비밀번호가 일치합니다."){
            $('#UserPass').focus();
            alert("비밀번호를 확인해 주십시오.");
            return;
        }

        //기등록 업체 일때... 아이디 추가 일때만 체크
        const reason = document.getElementById('ID_PW_ADD_REASON').value;
        if ($('#registeredCompany').is(':visible')) {

            if (reason == "") {
                $('#ID_PW_ADD_REASON').focus();
                alert("ID/PW 추가사유를 입력해 주세요.");
                return;
            }
        }


        // 접속목적
        const selectedGoals = [];
        $('#divGoal input[type="checkbox"]').each(function() {
            const isChecked = $(this).is(':checked');

            selectedGoals.push({
                id: $(this).attr("id"),
                checked: isChecked
            });
        });

        // JSON 데이터 저장
        const jsonData = JSON.stringify(selectedGoals);
        $('#checkboxDataJson').val(jsonData);

        document.getElementById('frmJoin').submit();
    }

</script>
</html>