<!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/defaultLayout}"
      layout:fragment="Content">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>변경관리</title>
</head>
<body>
<div class="cui_content">
  <div class="cui_main">
    <div class="cui_head">
      <div class="head_content">
        <h2 class="cui_title"><span>변경점관리</span></h2>
      </div>
    </div>
    <div class="cui_body">
      <form id="searchForm" method="get">
        <div class="cui_search">
          <div class="search_list cui_grid_wrap ">
            <div class="cui_items_wrap" data-direction="left">
              <strong class="item_label">플랜트</strong>
              <div class="item_content">
                <select class="cui_select_field">
                  <option value="">제목</option>
                  <option value="">제목</option>
                  <option value="">제목</option>
                  <option value="">제목</option>
                </select>
              </div>
            </div>
            <div class="cui_items_wrap" data-direction="left">
              <strong class="item_label">상태</strong>
              <div class="item_content">
                <select class="cui_select_field">
                  <option value="">제목</option>
                  <option value="">제목</option>
                  <option value="">제목</option>
                  <option value="">제목</option>
                </select>
              </div>
            </div>
            <div class="cui_items_wrap" data-direction="left">
              <strong class="item_label">업체명</strong>
              <div class="item_content">
                <input class="cui_text_field" type="text" placeholder="업체명을 입력해주세요">
                <button type="button" class="cui_button icon" data-cui-icon="search"><span>검색</span></button>
              </div>
            </div>
            <div class="cui_items_wrap required_field">
              <strong class="item_label">제목</strong>
              <div class="item_content">
                <input class="cui_text_field" type="text" placeholder="">
              </div>
            </div>
            <div class="cui_items_wrap required_field">
              <strong class="item_label">PCN_NO</strong>
              <div class="item_content">
                <input class="cui_text_field" type="text" placeholder="">
              </div>
            </div>
            <div class="cui_items_wrap" data-direction="left">
              <strong class="item_label">의뢰일</strong>
              <div class="item_content">
                <div class="cui_items_wrap">
                  <div class="item_content" data-role="calendar-picker" >
                    <input type="text" id="Sch_StartDate" class="cui_text_field cui_calendar_val" value="2024.12.13" onclick="SetDatePicker(this);">
                    <button type="button" class="cui_button icon endpoint cui_calendar_ico" data-cui-icon="calendar"><span>달력 선택</span></button>
                  </div>
                </div>
                <div class="field_connect">~</div>
                <div class="cui_items_wrap">
                  <div class="item_content" data-role="calendar-picker" >
                    <input type="text" id="Sch_EndDate" class="cui_text_field cui_calendar_val" value="2024.12.13" onclick="SetDatePicker(this);">
                    <button type="button" class="cui_button icon endpoint cui_calendar_ico" data-cui-icon="calendar"><span>달력 선택</span></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="search_action">
            <button type="submit" class="cui_button primary search_btn" id="searchBtn"><span>검색</span></button>
          </div>
        </div>
      </form>

      <div class="cui_jqGrid_section">
        <div class="cui_jqGrid_head">
          <div class="jqGrid_label"> PCN  List</div>
          <div class="jqGrid_aside">
            <button type="button" class="cui_button endpoint" data-cui-icon="folder_open"><span>협력업체 변경점 등급표</span></button>
            <button type="button" class="cui_button endpoint" data-cui-icon="download"><span>PCN 신고서</span></button>
            <button type="button" class="cui_button endpoint" data-cui-icon="upload"><span>PCN 등록</span></button>
            <button type="button" class="cui_button endpoint" data-cui-icon="trash"><span>선택삭제</span></button>
          </div>
        </div>
        <div class="cui_jqGrid_body" id="Grid">
          <table id="jqGrid">
          </table>
          <div id="jqGridPager"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="cui_dialog" style="width:1200px;display:none;" id="PopupChangeMgmt">
  <div class="dialog_container">
    <div class="dialog_head">
      <div class="dialog_title">
        <div class="main_label">PCN</div>
      </div>
      <div class="dialog_toolbar">
        <button class="cui_button icon endpoint modal-close" data-cui-icon="xmark"><span>Close</span></button>
      </div>
    </div>
    <div class="dialog_body">
      <div class="body_root">
        <form class="cui_form_field" data-legend="true" onsubmit="handleSubmit(event)" action="/admin/qualityCtrl/changeMgmt/action">
          <fieldset>
            <legend><span>PCN 내용</span></legend>
            <table class="cui_table">
              <colgroup>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
              </colgroup>
              <tbody>
              <tr>
                <th><span>PCN_NO</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>담당자</span></th>
                <td colspan="2">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>업체명</span></th>
                <td colspan="2">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th><span>플랜트</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>제목(원재료포함)</span></th>
                <td colspan="2">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>동시진행여부</span></th>
                <td colspan="2">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th><span>완료요청일</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>변경유형</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
                <th><span>목적</span></th>
                <td colspan="3">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="12341234" disabled>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th><span>변경전</span></th>
                <td colspan="3">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <textarea class="cui_text_field" rows="2" disabled></textarea>
                    </div>
                  </div>
                </td>
                <th><span>변경후</span></th>
                <td colspan="3">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <textarea class="cui_text_field" rows="2" disabled></textarea>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th><span>첨부파일</span></th>
                <td colspan="7">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">

                    </div>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>

            <legend><span>접수내역</span></legend>
            <table class="cui_table">
              <colgroup>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
              </colgroup>
              <tbody>
              <tr>
                <th><span>접수일</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="2024-11-15" disabled>
                    </div>
                  </div>
                </td>
                <th><span>진행완료 예정일</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="2024-11-15" disabled>
                    </div>
                  </div>
                </td>
                <th><span>접수의견</span></th>
                <td colspan="3">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <textarea class="cui_text_field" rows="2" disabled></textarea>
                    </div>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>

            <legend><span>승인내역</span></legend>
            <table class="cui_table">
              <colgroup>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
                <col style="width:154px;">
                <col>
              </colgroup>
              <tbody>
              <tr>
                <th><span>승인일</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input id="AppDate" class="cui_text_field" type="text" value="2024-11-15" disabled>
                    </div>
                  </div>
                </td>
                <th><span>승인여부</span></th>
                <td>
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <input class="cui_text_field" type="text" value="2024-11-15" disabled>
                    </div>
                  </div>
                </td>
                <th><span>특이사항</span></th>
                <td colspan="3">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">
                      <textarea class="cui_text_field" rows="2" disabled></textarea>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th><span>승인서</span></th>
                <td colspan="7">
                  <div class="cui_items_wrap" data-direction="left">
                    <div class="item_content">

                    </div>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </fieldset>
        </form>
        <div class="cui_items_wrap" data-direction="center" style="top-margin:10px;">
          <div class="item_content">
            <button type="button" id="BtnClose" name="INFO_FLAG" value="Close" class="cui_button primary modal-close"><span>닫기</span></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
<script>
  $(document).ready(function () {
    $('#searchBtn').on('click', function(event){
      event.preventDefault();  // 기본 폼 제출 동작 방지
    });

    $("#jqGrid").jqGrid({
          datatype: "json",
          colModel: [
              { label: 'PCN_NO', name: 'OrderID', key: true, width: 75 },
              { label: '제목(원재료 포함)', name: 'CustomerID', width: 150 },
              { label: '업체명', name: 'OrderDate', width: 100},
              { label: '상태', name: 'Freight', width: 75 },
              { label: '의뢰일', name: 'OrderDate', width: 75,formatter : 'date', formatoptions: { srcformat : 'Y-m-d H:i:s', newformat :'ShortDate'}},
              { label: '접수일', name: 'OrderDate', width: 75,formatter : 'date', formatoptions: { srcformat : 'Y-m-d H:i:s', newformat :'ShortDate'}},
              { label: '진행완료 예정일', name: 'OrderDate', width: 75,formatter : 'date', formatoptions: { srcformat : 'Y-m-d H:i:s', newformat :'ShortDate'}},
              { label: '승인일', name: 'OrderDate', width: 75,formatter : 'date', formatoptions: { srcformat : 'Y-m-d H:i:s', newformat :'ShortDate'}}
          ],
          viewrecords: true,
          autowidth: true,
          height: 250,
          rowNum: 20,
          pager: "#jqGridPager",
          emptyrecords: "데이터가 없습니다."       	// 레코드가 없을때 보여줄 문구
      });

      $(".cui_calendar_ico").on('click', function() {
        var inputField = $(this).prev('input');
        // datepicker가 보이면 숨기고, 숨겨져 있으면 보이도록 토글
        if (inputField.datepicker("widget").is(":visible")) {
            inputField.datepicker("hide"); // datepicker 숨기기
        } else {
            inputField.datepicker("show"); // datepicker 보이기
        }
      });

      $(".cui_calendar_val").on('click', function() {
        $(this).datepicker({
          dateFormat: 'yy-mm-dd',  // 날짜 포맷을 'YYYY-MM-DD'로 설정
          showOn: "focus",
        });
      });
  });

  $('.modal-close').on('click', function(e){
      e.preventDefault();
      const modal = $(this).parents('.cui_dialog');
      modal.fadeOut();
      modal_init();
    });
</script>